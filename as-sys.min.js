!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("lodash")):"function"==typeof define&&define.amd?define(["lodash"],t):(e=e||self).asSys=t(e._)}(this,function(c){"use strict";var n=function(e,t){if(e instanceof RegExp)return"string"==typeof t&&null!=t.match(e);if(t instanceof RegExp)return"string"==typeof e&&null!=e.match(t);if("object"!=typeof e||"object"!=typeof t)return e==t;for(var o in e)if(e.hasOwnProperty(o)&&t.hasOwnProperty(o)&&!n(e[o],t[o]))return!1;return!0},e=function(e,t){if(e.length<2)return!0;for(var o=e[0],n=1,r=e.length;n<r;++n)if(!1===t(o,e[n]))return!1;return!0},a=function(){for(var e,t,o=[],n=null,r=Array.prototype.slice.call(arguments,0),i=function(){var e=this.__skills;if(!this.__initializing){this.__initializing=!0;for(var t=0,o=e.length;t<o;++t)e[t].apply(this,arguments);delete this.__initializing}},p=0;p<r.length;++p)if(t=r[p],!(-1<o.indexOf(t))){if("function"!=typeof t||!t.prototype)throw"The skill listed ["+t+"] is not provided.";if(t.prototype.__depends){e=[p,0];for(var f,l=0,a=t.prototype.__depends.length;l<a;++l)f=t.prototype.__depends[l],-1==r.indexOf(f)&&e.push(f);if(2<e.length){Array.prototype.splice.apply(r,e),--p;continue}}if(null!=t.prototype.__expects){n=n||{};for(l=0,a=t.prototype.__expects.length;l<a;++l)n[t.prototype.__expects[l]]=!0}if(o.push(t),i.prototype=i.prototype===undefined?Object.create(t.prototype):c.extend(i.prototype,t.prototype),t.prototype.__skills!==undefined){l=0;for(var u,s=t.prototype.__skills.length;l<s;++l)u=t.prototype.__skills[l],-1==o.indexOf(u)&&o.push(u)}}return n&&c.each(n,function(e,t){if(!i.prototype[t])throw"The expected method ["+t+"] was not found among provided skills."}),Object.defineProperties(i.prototype,{__skills:{enumerable:!1,writable:!1,value:o}}),i};return a.VERSION="1.0.4",a.equal=function(){return e(arguments,c.isEqual)},a.similar=function(){return e(arguments,n)},a.setup=function(e,t){for(var o=1,n=c.keys(t);o<arguments.length;++o)c.merge(e,c.pick(arguments[o],n));return e},a.common=function(e){var t,o={},n={},r={},i=0,p=arguments.length;for("boolean"==typeof e&&(i=1);i<p;++i)for(var f in t=arguments[i])o[f]===undefined?(o[f]=1,n[f]=t[f]):!0===e&&n[f]!==t[f]||++o[f];for(var f in"boolean"==typeof e&&--p,o)o[f]==p&&(r[f]=n[f]);return r},a.weight=function(e){return"object"!=typeof e?1:e.hasOwnProperty("length")&&"number"==typeof e.length?e.length:Object.keys(e).length},a.clone=function(e){var t=Object.create(Object.getPrototypeOf(e));try{return e.constructor.apply(t,Array.prototype.slice(arguments,1))||t}catch(o){}},a.act=function(e,t){if(null!=e)return"string"==typeof t&&(t=e[t]),"function"==typeof t?t.apply(e,Array.prototype.slice.call(arguments,2)):void 0},a.broadcast=function(t,o){var n=Array.prototype.slice.call(arguments,2);return c.each(t.__skills,function(e){"function"==typeof e.prototype[o]&&e.prototype[o].apply(t,n)}),t},a.pass=function(e,t,o){for(var n,r=e.__skills&&e.__skills.indexOf(t);0<=--r;)if("function"==typeof(n=e.__skills[r]).prototype[o])return n.prototype[o].apply(e,Array.prototype.slice.call(arguments,3))},a.can=function(e,t){return"object"==typeof e&&"function"==typeof e[t]},a.aware=function(e,t){return"object"==typeof e&&e[t]!==undefined},a.capable=function(e,t){var o=Object.getPrototypeOf(e),n=1;"boolean"==typeof t&&(n=2);for(var r,i=0,p=n,f=arguments.length;p<f;++p)if(e instanceof(r=arguments[p]))++i;else if(Array.isArray(o.__skills))-1<o.__skills.indexOf(r)&&++i;else{var l=a.weight(r.prototype);0<l&&a.weight(a.common(!0,e,r.prototype))==l&&++i}return 0<i&&(!0!==t||arguments.length-n==i)},a.group=function(e,t,o){var n=this.clone(e),r={};for(var i in"boolean"!=typeof t&&(o=t,t=!1),e){var p=e[i];o.call(p,p,i,e)&&(t&&c.merge(r,Object.getPrototypeOf(p)),n.push(p))}if(t){for(var f,l=Object.keys(r),a={},u=0,s=l.length;u<s;++u)a[f=l[u]]={enumerable:!1,writable:!1,value:"function"!=typeof r[f]?r[f]:function(n){return function(){var e=undefined;for(var t in this){var o=this[t];"function"==typeof o[n]&&(e=o[n].apply(o,arguments))}return e}}(f)};Object.defineProperties(n,a)}return n},("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}).a$=a});